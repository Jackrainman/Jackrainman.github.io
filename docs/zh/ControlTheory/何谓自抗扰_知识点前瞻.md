# 自抗扰控制（ADRC）知识点前瞻

## 一、自抗扰控制概述

### 1.1 核心问题与解决思路

自抗扰控制（Active Disturbance Rejection Control, ADRC）由韩京清教授提出，其核心目标是**解决系统的不确定性控制问题**。在现实世界中，任何物理系统都面临两类扰动：
- **内部扰动**：系统参数变化、未建模动态、非线性特性
- **外部扰动**：环境干扰、负载变化、测量噪声

传统控制方法（如PID）对这类不确定性往往效果不佳，而ADRC的破局之道是**"化繁为简"**——通过实时估计与补偿机制，将复杂不确定系统转化为简单的理想系统。

### 1.2 ADRC的基本框架

ADRC框架包含三个核心组件：
1. **跟踪微分器（TD）**：安排过渡过程，使指令光滑化
2. **扩张状态观测器（ESO）**：实时估计总扰动
3. **非线性状态误差反馈控制律（NLSEF）**：生成控制量

---

## 二、积分器串联型系统

### 2.1 定义与本质

积分器串联型（Integrator Chain）是ADRC理论的基础概念。韩京清教授1979年提出：**无论系统是否线性，在一定条件下都可以回归于积分器串联型**。

数学上，一个n阶积分器串联型系统可表示为：
```
y → ∫∫...∫ u → y
```
这意味着输出是输入的n次积分。

### 2.2 典型实例

| 物理量 | 积分关系 |
|--------|----------|
| 位移 y | y = ∫∫ a dt² |
| 速度 v | v = ∫ a dt |
| 电荷 q | q = ∫ i dt |
| 流量 Q | Q = ∫ v dt |

### 2.3 意义

一旦所有控制问题都能转化为积分器串联型，就能实现**"一套研究处处用"**的普适性控制策略，大幅降低控制器设计复杂度。

---

## 三、总扰动（Total Disturbance）

### 3.1 概念定义

总扰动是ADRC最核心的概念之一。它将系统中所有**不确定因素打包为一个整体**：
- 系统内部非线性：$-a_1\dot{y} - a_0y$
- 参数不确定性：$\Delta a_1, \Delta a_0$
- 外部扰动：$d(t)$

数学表示：
$$f(y, \dot{y}, d, t) = -a_1\dot{y} - a_0y + d + \Delta a_1\dot{y} + \Delta a_0y$$

### 3.2 "两个自由度"视角

从控制结构看，总扰动处理体现了**两个自由度**的设计思想：

```
┌─────────────────────────────────────────┐
│              外环：Controller           │
│         设计期望的动态特性               │
└─────────────────────────────────────────┘
              ↑
              │ u₀
              ↓
┌─────────────────────────────────────────┐
│            内环：Rejector               │
│        抵消被控对象的不确定性           │
│        u = u₀ - f̂/b                    │
└─────────────────────────────────────────┘
```

- **去扰器（Rejector）**：内环，负责抵消不确定性
- **控制器（Controller）**：外环，设计期望性能

### 3.3 补偿公式

这是ADRC最关键的数学公式：
$$u = u_0 - \frac{\hat{f}}{b}$$

代入原系统方程：
$$\ddot{y} = f + b\left(u_0 - \frac{\hat{f}}{b}\right) = f - \hat{f} + b u_0 \approx b u_0$$

当估计准确时（$\hat{f} \approx f$），复杂系统被简化为纯积分串联型。

---

## 四、扩张状态观测器（ESO）

### 4.1 基本原理

扩张状态观测器是ADRC的"眼睛"，其核心思想是：
> **将总扰动视为一个待估计的状态变量**

### 4.2 为什么要"扩张"

常规状态观测器（如Luenberger观测器）只关注系统原生状态：
- $x_1 = y$（输出/位移）
- $x_2 = \dot{y}$（速度）

而ESO将总扰动$f$定义为新的状态：
- $x_3 = f$（扩张状态）

这就是"扩张"（Extended）的含义——**增加一个维度来估计扰动**。

### 4.3 状态空间方程

对于二阶系统 $\ddot{y} = f + bu$，扩张后的状态方程为：
$$\begin{cases}
\dot{x}_1 = x_2 \\
\dot{x}_2 = x_3 + bu \\
\dot{x}_3 = \dot{f} \\
y = x_1
\end{cases}$$

### 4.4 反馈修正机制

ESO的估计能力来源于**反馈校正**：

```
实际输出 y
    ↓
   误差 e = z₁ - y
    ↓
修正信号 ──┬──→ 修正 z₁（状态₁）
          ├──→ 修正 z₂（状态₂）
          └──→ 修正 z₃（总扰动）
```

关键洞察：如果模型预测的$z_1$与实际$y$不符，说明我们对扰动$z_3$的估计有误。这个误差会反馈修正所有状态估计。

---

## 五、线性扩张状态观测器（LESO）

### 5.1 LESO vs ESO

| 特性 | ESO | LESO |
|------|-----|------|
| 结构 | 非线性 | 线性 |
| 实现难度 | 较高 | 较低 |
| 工程应用 | 理论分析 | 工程实践 |
| 参数调节 | 复杂 | 相对简单 |

### 5.2 极点配置法

LESO设计的关键是**合理配置观测器极点**。

对于n阶系统，设计n+1阶LESO时，将所有极点配置在$-\omega_o$（观测器带宽）：
$$(s + \omega_o)^{n+1}$$

### 5.3 极点配置表

**二阶系统（n=2 → 3阶LESO）：**

| 极点位置 | 增益系数 |
|----------|----------|
| $l_1$ | $3\omega_o$ |
| $l_2$ | $3\omega_o^2$ |
| $l_3$ | $\omega_o^3$ |

**四阶系统（n=4 → 5阶LESO）：**

| 极点位置 | 增益系数 |
|----------|----------|
| $l_1$ | $5\omega_o$ |
| $l_2$ | $10\omega_o^2$ |
| $l_3$ | $10\omega_o^3$ |
| $l_4$ | $5\omega_o^4$ |
| $l_5$ | $\omega_o^5$ |

### 5.4 带宽$\omega_o$的选择

$\omega_o$是LESO最重要的设计参数：
- **增大$\omega_o$**：观测响应更快，估计更准确，但易受噪声影响
- **减小$\omega_o$**：滤波效果更好，但估计滞后

实际工程中需要权衡。

---

## 六、ADRC阶数确定

### 6.1 阶数与相对阶

ADRC/LADRC的阶数取决于**被控对象的相对阶**——即输出$y$对输入$u$最高阶导数的阶数。

### 6.2 n阶系统与n+1阶观测器

**ADRC的核心法则**：n阶系统必须配备n+1阶观测器。

| 系统阶数n | 需估计的状态 | 观测器阶数 |
|-----------|-------------|-----------|
| 1 | $y, \dot{y}, f$ | 2 |
| 2 | $y, \dot{y}, \ddot{y}, f$ | 3 |
| 4 | $y, \dot{y}, \ddot{y}, \dddot{y}, f$ | 5 |

### 6.3 阶数的物理意义

阶数代表控制信号$u$需要经过**多少次积分累积**才能影响输出$y$。

例如：
- 弹簧阻尼系统：力→加速度→速度→位移（3阶）
- 电机系统：电压→电流→转矩→速度→位置（4阶）

---

## 七、跟踪微分器（TD）

### 7.1 作用

跟踪微分器有两个核心功能：
1. **安排过渡过程**：使输入指令光滑化
2. **提取微分信号**：从噪声信号中提取可靠的微分

### 7.2 物理意义

在控制系统中，直接对指令求导会产生噪声放大问题。TD通过安排合理的过渡过程，既保证输出能跟踪指令，又避免剧烈的控制动作。

### 7.3 与ESO的关系

TD主要处理**指令信号**，而ESO主要处理**输出信号**。两者协同工作：
- TD为控制器提供光滑的指令和微分
- ESO为控制器提供扰动估计

---

## 八、非线性组合

### 8.1 与PID的区别

传统PID使用**线性组合**：
$$u = K_P e + K_I \int e + K_D \dot{e}$$

ADRC的**非线性组合**（NLSEF）使用非线性函数：
$$u_0 = k_1 \cdot \text{fal}(e_1, \alpha_1, \delta) + k_2 \cdot \text{fal}(e_2, \alpha_2, \delta)$$

### 8.2 fal函数

fal函数是ADRC中常用的非线性函数：
$$\text{fal}(e, \alpha, \delta) = \begin{cases}
|e|^\alpha \cdot \text{sgn}(e), & |e| > \delta \\
e / \delta^{1-\alpha}, & |e| \leq \delta
\end{cases}$$

特点：
- **小误差时**：高增益（$|e|^\alpha$），快速收敛
- **大误差时**：低增益（$e/\delta^{1-\alpha}$），避免超调

---

## 九、设计范式与步骤

### 9.1 完整设计流程

```
┌────────────────────────────────────────────────────┐
│  步骤1：建立过程动态方程                            │
│  $\ddot{y} = f(y, \dot{y}, d, t) + bu$             │
└────────────────────────────────────────────────────┘
                        ↓
┌────────────────────────────────────────────────────┐
│  步骤2：确定系统阶数n                              │
│  根据最高阶导数确定（此处n=2）                      │
└────────────────────────────────────────────────────┘
                        ↓
┌────────────────────────────────────────────────────┐
│  步骤3：设计n+1阶LESO                              │
│  配置观测器带宽$\omega_o$，计算增益$l_i$            │
└────────────────────────────────────────────────────┘
                        ↓
┌────────────────────────────────────────────────────┐
│  步骤4：设计控制律                                  │
│  $u = u_0 - \hat{f}/b$                             │
└────────────────────────────────────────────────────┘
                        ↓
┌────────────────────────────────────────────────────┐
│  步骤5：参数整定                                    │
│  调节$\omega_o, b, k_1, k_2$等参数                 │
└────────────────────────────────────────────────────┘
```

### 9.2 关键参数说明

| 参数 | 符号 | 作用 |
|------|------|------|
| 观测器带宽 | $\omega_o$ | 决定扰动估计速度 |
| 输入系数 | $b$ | 控制系统增益 |
| 控制增益 | $k_1, k_2$ | 决定闭环响应速度 |
| 非线性参数 | $\alpha, \delta$ | 改善暂态性能 |

---

## 十、工程应用要点

### 10.1 适用场景

ADRC特别适合以下系统：
- 模型未知或难以建立的系统
- 参数大幅变化的系统
- 存在强外部扰动的系统
- 非线性严重的系统

### 10.2 与其他方法的比较

| 特性 | PID | 自适应控制 | ADRC |
|------|-----|------------|------|
| 鲁棒性 | 一般 | 较好 | 优秀 |
| 依赖模型 | 否 | 是 | 否 |
| 参数调节 | 简单 | 复杂 | 中等 |
| 实时计算量 | 低 | 高 | 中等 |

### 10.3 常见问题与解决

1. **ESO估计不准确**
   - 检查$\omega_o$是否设置合理
   - 确认$b$参数是否接近实际值

2. **控制存在抖动**
   - 适当减小$\omega_o$
   - 增大fal函数的$\delta$参数

3. **稳态误差**
   - 增加积分环节
   - 减小非线性参数$\alpha$

---

## 十一、总结与思考

### 11.1 核心思想回顾

1. **不确定性打包**：将所有扰动打包为"总扰动"
2. **实时估计补偿**：通过ESO实时估计并抵消
3. **化繁为简**：将复杂系统转化为积分串联型
4. **扩张观测**：增加状态维度来估计不可测扰动

### 11.2 学习建议

1. 先理解**积分器串联型**概念
2. 深入理解**总扰动**的定义和物理意义
3. 掌握**ESO/LESO**的数学原理
4. 通过仿真和实际案例加深理解
5. 注意参数整定的工程实践

---

## 十二、扩展阅读建议

- 韩京清教授原著：《自抗扰控制技术》
- 高志强教授相关论文
- LADRC工程化实现论文
- MATLAB/Simulink中的ADRC工具箱
